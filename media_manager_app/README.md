# Media Manager App

åª’ä½“ç®¡ç†å™¨çš„ Flutter å‰ç«¯åº”ç”¨ã€‚æ”¯æŒ Androidã€iOSã€Windowsã€macOSã€Linux å¤šå¹³å°ã€‚

## ğŸŒŸ ç‰¹æ€§

### åŒæ¨¡å¼è¿è¡Œ
- **ç‹¬ç«‹æ¨¡å¼**ï¼šå®Œå…¨ç‹¬ç«‹è¿è¡Œï¼Œæ— éœ€åç«¯æœåŠ¡å™¨
  - æœ¬åœ° SQLite æ•°æ®åº“
  - å†…ç½® HTTP æœåŠ¡å™¨ï¼ˆç«¯å£ 8080ï¼‰
  - å†…ç½®åˆ®å‰ŠåŠŸèƒ½ï¼ˆKiteyuanã€Knabenï¼‰
  
- **PC æ¨¡å¼**ï¼šè¿æ¥ Rust åç«¯
  - è‡ªåŠ¨åŒæ­¥æ•°æ®
  - æ’ä»¶ç³»ç»Ÿæ”¯æŒ
  - æ›´å¼ºå¤§çš„åˆ®å‰ŠåŠŸèƒ½

### æ ¸å¿ƒåŠŸèƒ½
- ğŸ“š åª’ä½“åº“ç®¡ç†ï¼ˆæµè§ˆã€æœç´¢ã€ç­›é€‰ï¼‰
- ğŸ‘¥ æ¼”å‘˜ä¿¡æ¯ç®¡ç†
- â­ ä¸ªäººæ”¶è—å’Œè¯„åˆ†
- ğŸ”Œ æ²¹çŒ´è„šæœ¬é›†æˆ
- ğŸ” ç£åŠ›æœç´¢
- ğŸ¨ Material Design 3 UI
- ğŸŒ“ æ·±è‰²/æµ…è‰²ä¸»é¢˜

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Flutter SDK 3.0+
- Dart SDK 3.0+

### å®‰è£…ä¾èµ–
```bash
flutter pub get
```

### è¿è¡Œåº”ç”¨
```bash
# å¼€å‘æ¨¡å¼
flutter run

# å‘å¸ƒæ¨¡å¼
flutter run --release
```

### æ„å»ºåº”ç”¨
```bash
# Android APK
flutter build apk --release

# Android App Bundle
flutter build appbundle --release

# iOS
flutter build ios --release

# Windows
flutter build windows --release

# macOS
flutter build macos --release

# Linux
flutter build linux --release
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
lib/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/                       # æ ¸å¿ƒåŠŸèƒ½
â”‚   â”‚   â”œâ”€â”€ config/                 # é…ç½®
â”‚   â”‚   â”œâ”€â”€ database/               # æœ¬åœ°æ•°æ®åº“
â”‚   â”‚   â”‚   â””â”€â”€ local_database.dart # SQLite æ•°æ®åº“å®ç°
â”‚   â”‚   â”œâ”€â”€ models/                 # æ•°æ®æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ media_item.dart     # åª’ä½“æ¨¡å‹
â”‚   â”‚   â”‚   â”œâ”€â”€ actor.dart          # æ¼”å‘˜æ¨¡å‹
â”‚   â”‚   â”‚   â””â”€â”€ collection.dart     # æ”¶è—æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ repositories/           # æ•°æ®ä»“åº“å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ media_repository.dart
â”‚   â”‚   â”‚   â”œâ”€â”€ actor_repository.dart
â”‚   â”‚   â”‚   â””â”€â”€ collection_repository.dart
â”‚   â”‚   â”œâ”€â”€ services/               # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ backend_mode.dart           # æ¨¡å¼ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ local_http_server.dart      # æœ¬åœ°æœåŠ¡å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ scraper_service.dart        # åˆ®å‰ŠæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ api_service.dart            # API æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ app_initializer.dart        # åº”ç”¨åˆå§‹åŒ–
â”‚   â”‚   â”œâ”€â”€ providers/              # Riverpod æä¾›è€…
â”‚   â”‚   â”œâ”€â”€ router/                 # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ theme/                  # ä¸»é¢˜é…ç½®
â”‚   â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ features/                   # åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ media/                  # åª’ä½“ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ data/               # æ•°æ®å±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ domain/             # ä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â”‚   â””â”€â”€ presentation/       # UI å±‚
â”‚   â”‚   â”œâ”€â”€ actors/                 # æ¼”å‘˜ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ collection/             # æ”¶è—ç®¡ç†
â”‚   â”‚   â””â”€â”€ settings/               # è®¾ç½®
â”‚   â”œâ”€â”€ shared/                     # å…±äº«ç»„ä»¶
â”‚   â”‚   â””â”€â”€ widgets/                # é€šç”¨ Widget
â”‚   â””â”€â”€ app.dart                    # åº”ç”¨å…¥å£
â””â”€â”€ main.dart                       # ä¸»å‡½æ•°
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒæ¡†æ¶
- **Flutter**: 3.x
- **Dart**: 3.x

### çŠ¶æ€ç®¡ç†
- **Riverpod**: 2.x - å“åº”å¼çŠ¶æ€ç®¡ç†

### è·¯ç”±
- **GoRouter**: å£°æ˜å¼è·¯ç”±

### æœ¬åœ°å­˜å‚¨
- **sqflite**: SQLite æ•°æ®åº“
- **shared_preferences**: é”®å€¼å­˜å‚¨

### ç½‘ç»œ
- **Dio**: HTTP å®¢æˆ·ç«¯
- **shelf**: HTTP æœåŠ¡å™¨ï¼ˆæ¥æ”¶æ²¹çŒ´æ•°æ®ï¼‰

### UI
- **Material Design 3**: ç°ä»£åŒ– UI
- **cached_network_image**: å›¾ç‰‡ç¼“å­˜
- **flutter_svg**: SVG æ”¯æŒ

### å·¥å…·
- **json_annotation**: JSON åºåˆ—åŒ–
- **build_runner**: ä»£ç ç”Ÿæˆ

## ğŸ¯ æ¨¡å¼è¯´æ˜

### ç‹¬ç«‹æ¨¡å¼ï¼ˆStandalone Modeï¼‰
åº”ç”¨å®Œå…¨ç‹¬ç«‹è¿è¡Œï¼Œé€‚åˆç§»åŠ¨ç«¯ç”¨æˆ·ã€‚

**ç‰¹ç‚¹**ï¼š
- âœ… æ— éœ€åç«¯æœåŠ¡å™¨
- âœ… æœ¬åœ° SQLite æ•°æ®åº“
- âœ… å†…ç½® HTTP æœåŠ¡å™¨ï¼ˆç«¯å£ 8080ï¼‰
- âœ… å†…ç½®åˆ®å‰ŠåŠŸèƒ½
- âš ï¸ æ— æ’ä»¶ç³»ç»Ÿ

**é€‚ç”¨åœºæ™¯**ï¼š
- ç§»åŠ¨ç«¯æ—¥å¸¸ä½¿ç”¨
- æ—  PC ç¯å¢ƒ
- ç®€å•çš„åª’ä½“ç®¡ç†éœ€æ±‚

### PC æ¨¡å¼ï¼ˆPC Modeï¼‰
è¿æ¥åˆ° Rust åç«¯ï¼Œè·å¾—å®Œæ•´åŠŸèƒ½ã€‚

**ç‰¹ç‚¹**ï¼š
- âœ… è‡ªåŠ¨åŒæ­¥æ•°æ®
- âœ… æ’ä»¶ç³»ç»Ÿæ”¯æŒ
- âœ… æ›´å¼ºå¤§çš„åˆ®å‰ŠåŠŸèƒ½
- âœ… å¤šè®¾å¤‡ååŒ
- âš ï¸ éœ€è¦åç«¯è¿è¡Œ

**é€‚ç”¨åœºæ™¯**ï¼š
- PC + ç§»åŠ¨ç«¯ååŒ
- éœ€è¦æ’ä»¶åŠŸèƒ½
- å¤šè®¾å¤‡æ•°æ®åŒæ­¥

### æ¨¡å¼åˆ‡æ¢
åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹ï¼š
1. å°è¯•è¿æ¥åç«¯ï¼ˆlocalhost:3000ï¼‰
2. å¦‚æœè¿æ¥æˆåŠŸ â†’ PC æ¨¡å¼
3. å¦‚æœè¿æ¥å¤±è´¥ â†’ ç‹¬ç«‹æ¨¡å¼

å¯ä»¥åœ¨è®¾ç½®ä¸­æ‰‹åŠ¨åˆ‡æ¢æˆ–é…ç½®åç«¯åœ°å€ã€‚

## ğŸŒ æ²¹çŒ´è„šæœ¬é›†æˆ

### å·¥ä½œåŸç†
1. åº”ç”¨å¯åŠ¨æœ¬åœ° HTTP æœåŠ¡å™¨ï¼ˆç«¯å£ 8080ï¼‰
2. æ²¹çŒ´è„šæœ¬ä»ç½‘ç«™æå–æ•°æ®
3. è„šæœ¬é€šè¿‡ HTTP POST å‘é€æ•°æ®åˆ°åº”ç”¨
4. åº”ç”¨æ¥æ”¶å¹¶ä¿å­˜åˆ°æ•°æ®åº“

### API ç«¯ç‚¹
- `POST /api/media` - æ¥æ”¶åª’ä½“æ•°æ®
- `POST /api/actors` - æ¥æ”¶æ¼”å‘˜æ•°æ®

### æ•°æ®æ ¼å¼
```json
{
  "code": "ABC-123",
  "title": "ç¤ºä¾‹æ ‡é¢˜",
  "media_type": "Censored",
  "genres": ["ç±»å‹1", "ç±»å‹2"],
  "cast": [
    {"name": "æ¼”å‘˜å", "role": "Actor"}
  ],
  "download_links": [
    {
      "name": "ç£åŠ›é“¾æ¥",
      "url": "magnet:?xt=...",
      "link_type": "magnet",
      "size": "4.5GB"
    }
  ]
}
```

## ğŸ” å¼€å‘æŒ‡å—

### ä»£ç ç”Ÿæˆ
```bash
# ç”Ÿæˆ JSON åºåˆ—åŒ–ä»£ç 
dart run build_runner build --delete-conflicting-outputs

# ç›‘å¬æ–‡ä»¶å˜åŒ–è‡ªåŠ¨ç”Ÿæˆ
dart run build_runner watch
```

### ä»£ç åˆ†æ
```bash
# è¿è¡Œé™æ€åˆ†æ
flutter analyze

# æ ¼å¼åŒ–ä»£ç 
dart format .
```

### æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
flutter test

# è¿è¡Œç‰¹å®šæµ‹è¯•
flutter test test/core/database/local_database_test.dart
```

### è°ƒè¯•
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
flutter run --verbose

# æ€§èƒ½åˆ†æ
flutter run --profile
```

## ğŸ“± å¹³å°ç‰¹å®šé…ç½®

### Android
- æœ€ä½ SDK: 21 (Android 5.0)
- ç›®æ ‡ SDK: 34 (Android 14)
- ç½‘ç»œæƒé™å·²é…ç½®
- æ¸…å•æ–‡ä»¶: `android/app/src/main/AndroidManifest.xml`

### iOS
- æœ€ä½ç‰ˆæœ¬: iOS 12.0
- ç½‘ç»œæƒé™å·²é…ç½®ï¼ˆNSAppTransportSecurityï¼‰
- Info.plist: `ios/Runner/Info.plist`

### Windows
- æœ€ä½ç‰ˆæœ¬: Windows 10
- éœ€è¦ Visual C++ Redistributable

### macOS
- æœ€ä½ç‰ˆæœ¬: macOS 10.14
- ç½‘ç»œæƒé™å·²é…ç½®

### Linux
- éœ€è¦ GTK 3.0+
- éœ€è¦ç›¸å…³å¼€å‘åº“

## ğŸ› å¸¸è§é—®é¢˜

### æ„å»ºå¤±è´¥
```bash
# æ¸…ç†ç¼“å­˜
flutter clean
flutter pub get

# é‡æ–°ç”Ÿæˆä»£ç 
dart run build_runner clean
dart run build_runner build --delete-conflicting-outputs
```

### æ•°æ®åº“é”™è¯¯
- æ£€æŸ¥æ•°æ®åº“ç‰ˆæœ¬è¿ç§»
- æŸ¥çœ‹ `local_database.dart` ä¸­çš„ `_onUpgrade` æ–¹æ³•
- å¿…è¦æ—¶å¸è½½åº”ç”¨é‡æ–°å®‰è£…

### ç½‘ç»œè¿æ¥é—®é¢˜
- æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
- ç¡®è®¤åç«¯åœ°å€æ­£ç¡®
- ç§»åŠ¨ç«¯ä½¿ç”¨ PC çš„å±€åŸŸç½‘ IP

### æ²¹çŒ´è„šæœ¬æ— æ³•è¿æ¥
- ç¡®ä¿åº”ç”¨åœ¨å‰å°è¿è¡Œï¼ˆç§»åŠ¨ç«¯ï¼‰
- æ£€æŸ¥ç«¯å£æ˜¯å¦æ­£ç¡®ï¼ˆ8080ï¼‰
- æŸ¥çœ‹åº”ç”¨æ—¥å¿—

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®ä¸» README](../README.md)
- [iOS è®¾ç½®æŒ‡å—](../docs/iOS_SETUP.md)
- [å¼€å‘ç¯å¢ƒè®¾ç½®](../setup.md)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License
